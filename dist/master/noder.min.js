/*
 * Noder-js 1.2.0-rc1 - 19 Feb 2014
 * https://github.com/ariatemplates/noder-js
 * Copyright 2009-2014 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0.
 */
(function(n,e,t){"use strict";var r,i,o,u,a,s,l,c,f,d,h,v,p,m,g,y,x,j,w,E,M,b,S,A;return function(){var n=Object.prototype.toString,e=function(e){return"string"==typeof e||"[object String]"===n.call(e)},t=Array.isArray||function(e){return"[object Array]"===n.call(e)},i=function(n){return"function"==typeof n},o=function(e){return e?"[object Object]"===n.call(e):!1};r={isFunction:i,isArray:t,isString:e,isPlainObject:o}}(),function(){var n=function(e,t,i){for(var o in t)if(t.hasOwnProperty(o)){var u,a=t[o];i&&r.isPlainObject(a)&&r.isPlainObject(u=e[o])?n(u,a,i):e[o]=a}};i=n}(),function(){var e=n.setTimeout;o=function(n){e(n,0)}}(),u=function(n){o(function(){throw n.logDetails&&n.logDetails(),n})},function(){var n=[],e=!1,t=function(n,e,t){for(;n.length>0;){var r=n.shift();try{r.apply(t,e)}catch(i){u(i)}}},r=function(){e=!0;try{t(n,[])}finally{e=!1}},i=function(t){0!==n.length||e||o(r),n.push(t)};a={syncTick:r,nextTick:i,nextTickApply:function(n,e,r){n&&n.length>0&&i(function(){t(n,e,r)})},syncApply:t}}(),function(){var n=r.isFunction,e=Array.prototype.concat,t=function(e,t,r){if(e){var i=e.thenSync||e.then;if(n(i))return i.call(e,t,r),void 0}t(e)},o=function(n,e){return function(){try{var r=n.apply(null,arguments);t(r,e.resolve,e.reject)}catch(i){e.reject(i)}finally{n=null,e=null}}},l=function(){},c=function(){var n=new l,t=new l,r="pending",o=null,u={},s=function(n,i,s){var l=function(i,a){t[n+i]=function(){var n;return"pending"===r?(n=u[s]||[],u[s]=e.apply(n,arguments)):r===s&&(n=e.apply([],arguments),a(n,o)),this}};l("",a.nextTickApply),l("Sync",a.syncApply),t[i]=function(){if("pending"===r){o=arguments,r=s;var n=u[s];u=null,a.nextTickApply(n,o)}}};return s("done","resolve","resolved"),s("fail","reject","rejected"),t.state=function(){return r},t.promise=function(){return t},t.result=function(){return o&&o[0]},i(n,t),n},f=c.prototype=l.prototype={end:function(){return this.thenSync(c.empty,u)}},d=function(e){var t="done"+e,r="fail"+e;f["then"+e]=function(e,i){var u=c();return this[t](n(e)?o(e,u):u.resolve),this[r](n(i)?o(i,u):u.reject),u.promise()},f["always"+e]=function(){return this[t].apply(this,arguments),this[r].apply(this,arguments),this}};d("Sync"),d("");var h=c();h.resolve(),c.done=h.promise(),c.empty=function(){},c.noop=function(){return h};var v=function(n,e){return function(t){return function(r){if(n){if(n[3]&&(t?n[2][e]=r:(n[3]=!1,n[2]=arguments,n[4]&&(n[1]=1))),n[1]--,!n[1]){var i=n[0],o=n[2];n[0]=n[2]=null,(n[3]?i.resolve:i.reject).apply(i,o)}n=null}}}},p=function(n){return function(){var r=e.apply([],arguments);if(!r.length)return c.done;for(var i=c(),o=[i,r.length,r,!0,n],u=0,a=r.length;a>u;u++){var s=v(o,u);t(r[u],s(!0),s(!1))}return i.promise()}};c.when=p(!0),c.whenAll=p(!1),s=c}(),l=t,function(){var n,e=0,t=function(){var n=!1,e=this,t=r().thenSync(function(t){return t.call(e,n)});return n=!0,t},r=function(){if(!n){var e=l().errorContext,t=new M(e);n=t.moduleExecute(t.getModule(e.main))}return n},i=function(n,r,i){var o=++e,u=Error("NoderError #"+o+": "+n);return u.name="NoderError",u.id=o,u.code=n,u.args=r,u.cause=i,u.logDetails=t,u};c=i}(),function(){var e,t=n.XMLHttpRequest;t?e=function(){return new t}:(t=n.ActiveXObject,e=function(){return new t("Microsoft.XMLHTTP")});var r=function(n,e,t){return function(){if(e&&4==e.readyState){var r=200!=e.status;r?t.reject(c("XMLHttpRequest",[n,e])):t.resolve(e.responseText,e),n=e=t=null}}};f=function(n,t){t=t||{};var i=s(),o=e(),u=t.headers||{};o.open(t.method||"GET",n,!t.sync);for(var a in u)u.hasOwnProperty(a)&&o.setRequestHeader(a,u[a]);return o.onreadystatechange=r(n,o,i),o.send(t.data),i.promise()}}(),function(){var n,t=function(t,r){var i={};return t=r?["/*\n * File: ",r,"\n */\narguments[1].res=",t,"\n//",n?"#":"@"," sourceURL=",r].join(""):"arguments[1].res="+t,e(t,i),i.res};n=t("/*@cc_on!@*/0"),d=t}(),h=function(n,e,t){try{return d(n,e)}catch(r){throw c("jsEval",[n,e,t],r)}},function(){var n=r.isPlainObject;v=function(e,t,r){if(!e)return r;r=e["**"]||r;for(var i=0,o=t.length;o>i;i++){var u=t[i],a=e[u];if(!a)return e["*"]||e["**"]||r;if(!n(a))return a;r=e["**"]||r,e=a}return e["."]||e["*"]||e["**"]||r}}(),function(){var n=function(n){return n.length?n.split("/"):[]},e=function(e){var t=n(e);return t.pop(),t.join("/")};p={split:n,dirname:e}}(),function(){var e=n.document||{},t=function(){if("loading"==e.readyState||"interactive"==e.readyState){var n=e.getElementsByTagName("script"),t=n[n.length-1];if(t&&t.src)return t}};m=e.currentScript||t()||{}}(),g=function(){var n=m.src;return n?p.dirname(n.replace(/\?.*$/,""))+"/":""},function(){var n=p.split,e={},t=function(n){var t=n.config.packaging||e;this.config=t,this.baseUrl=(t.baseUrl||"").replace(/^%scriptdir%\//,g()),this.context=n,this.currentLoads={};var r=t.bootstrap;r&&r(n.define)},r=t.prototype={};r.moduleLoad=function(t){var r,i=t.filename,o=this.config.packagesMap;if(o){var u=n(i);r=v(o||e,u,null)}return r?this.loadPackaged(r):this.loadUnpackaged(t)},r.loadUnpackaged=function(n){var e=n.filename,t=this.baseUrl+e,r=this.context;return f(t,this.config.requestConfig).thenSync(function(n){r.jsModuleDefine(n,e,t)}).always(function(){r=null})},r.loadPackaged=function(n){var e=this,t=e.baseUrl+n,r=e.currentLoads[t];return r||(e.currentLoads[t]=r=f(t,e.config.requestConfig).thenSync(function(n){var r=e.jsPackageEval(n,t);r(e.context.define)}).always(function(){delete e.currentLoads[t],e=null})),r},r.jsPackageEval=function(n,e){var t=["(function(define){\n",n,"\n})"];return h(t.join(""),e,1)},y=t}(),function(){var n=r.isString,e=p.split,t={},i=function(n){var e=n.length-1,t=n[e];-1==t.indexOf(".")&&(n[e]=t+".js")},o=function(n){for(var e=0,t=n.length;t>e;e++){var r=n[e];r.length&&"."!=r?".."==r&&e>0&&".."!=n[e-1]&&(n.splice(e-1,2),e-=2,t-=2):(n.splice(e,1),e--,t--)}return n},u=function(n,t,r){var i=e(t);i[0].length?i.unshift(r,1):(i.shift(),i.unshift(0,r+1)),n.splice.apply(n,i)},a=function(e,t){for(var r=0,i=t.length;i>r;r++){var o=t[r];if(e=e[o],!e||o===e)return!1;if(n(e))return u(t,e,r),!0}return u(t,e["."]||"index.js",t.length),!0},s=function(n,e){var t={},r=".";o(e);for(var i=e.join("/");i!==r;){if(".."==e[0])throw c("resolverRoot",[e]);if(t[i])throw c("resolverLoop",[e]);t[i]=r,a(n,e)&&o(e),r=i,i=e.join("/")}},l=function(n){this.config=n.config.resolver||t,this.cache={}},f=l.prototype={};f.moduleResolve=function(n,r){var o=e(n.filename),u=this.config["default"]||t,a=e(r),l=a[0];return("."===l||".."===l)&&(o.pop(),a=o.concat(a)),s(u,a),i(a),a.join("/")},x=l}(),function(){var e,t=function(){var e=n.document;if(!e||"complete"===e.readyState)return s.done;var t=s(),r=function(){t&&t.resolve()};return e.addEventListener?(e.addEventListener("DOMContentLoaded",r),n.addEventListener("load",r),t.always(function(){e.removeEventListener("DOMContentLoaded",r),n.removeEventListener("load",r),e=null,r=null,t=null})):e.attachEvent&&(n.attachEvent("onload",r),t.always(function(){n.detachEvent("onload",r),e=null,r=null,t=null})),t.promise()};j=function(){return e||(e=t()),e}}(),function(){var e=function(n,e){return function(){return n.moduleExecute(e).end()}};w=function(t,r){return j().then(function(){var i=n.document,o=s.done;if(i){var a,l,c=i.getElementsByTagName("script");for(a=0,l=c.length;l>a;a++){var f=c[a];if(f.type===r){var d=f.getAttribute("data-filename");try{var h=t.jsModuleDefine(f.innerHTML,d);o=o.then(e(t,h))}catch(v){u(v)}}}}return o}).end()}}(),function(){var n=/(?=[\/'"]|\brequire\s*\()/,e=/^require\s*\(\s*$/,t=/[\r\n]/,r=/^['"]$/,i=/^(\w{2,}|[!%&\(*+,\-\/:;<=>?\[\^])$/,o=/^\s*(\S)/,u=/(\b(return|throw|new|in)|\S)\s*$/,a=/\s*\)\s*\.\s*([_$a-zA-Z][_$a-zA-Z0-9]*)\s*\(\s*/g,s=/[_$a-zA-Z][_$a-zA-Z0-9]*/g,l=/\s*(\)|,)\s*/g,c=function(n){for(var e=!1,t=n.length-1;t>=0&&"\\"==n.charAt(t);)t--,e=!e;return e},f=function(n,e){for(;e>=0;e--){var t=n[e];if(u.test(t))return RegExp.$1}return""},d=function(n,e){return 0===e||"."!=f(n,e-1)},h=function(n,e){return 0===e||i.test(f(n,e-1))},v=function(n,e){var t=n[e].charAt(0);e++;for(var r=n.length;r>e;e++){var i=n[e].charAt(0);if(i===t&&!c(n[e-1]))break}return e},p=function(n,e){for(var r=e+1,i=n.length;i>r;r++){var o=n[r],u=o.search(t);if(u>-1){n[r]=o.substring(u);break}}return n.splice(e,r-e),e},m=function(n,e){var t=e+1;"/*"==n[e]&&t++;for(var r=n[t-1],i=n.length;i>t;t++){var o=r;if(r=n[t],"*"==o.charAt(o.length-1)&&"/"==r.charAt(0)){n[t]=r.substring(1);break}}return n.splice(e,t-e),e},g=function(t){for(var i=[],u=[],a=0,s=t.split(n),l=s.length,c=-1;l>a&&a>=0;a++){var f=s[a],g=f.charAt(0);if("/"==g)"/"==f&&l>a+1&&"/"==s[a+1].charAt(0)?(a=p(s,a),l=s.length):"*"==f.charAt(1)?(a=m(s,a),l=s.length):h(s,a)&&(a=v(s,a));else if(r.test(g)){var y=a;a=v(s,a),i.push([y,a]),2==c&&(c=3)}else"r"==g&&e.test(f)&&d(s,a)&&(c=1);c>0&&(1==c?c=2:(f=s[a],3==c&&(f=f.substring(1),c=4),o.test(f)&&(4==c&&")"==RegExp.$1&&u.push(i.length-1),c=0)))}return[s,i,u]},y=function(n){for(var e=[0],t=1,r=n.length;r>=t;t++)e[t]=e[t-1]+n[t-1].length;return function(n){return[e[n[0]]+1,e[n[1]]]}},x=function(n,e){return n.substring.apply(n,e)},j=function(n,e,t){n.lastIndex=t;var r=n.exec(e);return r&&r.index==t?r:void 0},w=/(^|\/)\$[^\/]*$/;E=function(n,e){var t=g(n),r=t[2],i=r.length,o={},u=[];if(r.length)for(var c=y(t[0]),f=t[0].join(""),d=t[1],h=d.length,v=0;i>v;v++){var p=r[v],m=c(d[p]),E=x(f,m);if(o[E]||(u.push(E),o[E]=!0),e&&w.test(E)){var M=j(a,f,m[1]+1);if(M){var b=M[1],S=[],A=h>++p&&c(d[p]);do{var P=M.index+M[0].length;if(A&&P+1===A[0])S.push(x(f,A)),P=A[1]+1,A=h>++p&&c(d[p]);else{if(M=j(s,f,P),!M)break;P=s.lastIndex,S.push([M[0]])}M=j(l,f,P)}while(M&&","==M[1]);M&&u.push({module:E,method:b,args:S})}}}return u}}(),function(){var e=p.dirname,t=function(n,e){return function(){return n.apply(e,arguments)}},i=function(n,e,t){return function(r){return n.call(e,t,r)}},o=function(n,e){return function(){return n.moduleAsyncRequire(e,arguments)}},u=function(n,t){this.dirname=t?e(t):t=".",this._noder={},this.filename=t,this.id=t,this.require=i(n.moduleRequire,n,this),this.require.resolve=i(n.moduleResolve,n,this),this.require.cache=n.cache,this.parent=null,this.children=[],this.preloaded=!1,this.loaded=!1,this.exports={}},a=function(n,e){return n._noder[e]},l=function(n,e,t){return n._noder[e]=t,t},f=function(n){var e=n.config,t=s.done,r=e.main;t=t.thenSync(r?function(){return n.execModuleCall(r)}:s.empty),t=t.thenSync(e.onstart),"scriptsType"in e||(e.scriptsType=e.varName);var i=e.scriptsType;return i&&(t=t.thenSync(function(){return w(n,i)})),t.always(function(){n=null,e=null,t=null})},d=function(){},v=function(n,e,t){var r=n||e;return new r(t,e)},m=function(e){e=e||{},this.config=e,this.cache={},this.builtinModules=new d,this.when=e.failFast===!1?s.whenAll:s.when;var r=new u(this);r.preloaded=!0,r.loaded=!0,r.define=this.define=t(this.define,this),r.asyncRequire=o(this,r),r.execute=t(this.jsModuleExecute,this),r.createContext=m.createContext,this.rootModule=r,this.resolver=v(e.Resolver,x,this),this.loader=v(e.Loader,y,this);var i=e.varName;i&&(n[i]=r),f(this).end()},g=m.prototype={},j=function(n,e){if(e===n)return!0;var t=a(e,5);if(t)for(var r=0;t[r];r++)if(j(n,t[r]))return!0;return!1};g.modulePreload=function(n,e){if(n.preloaded)return s.done;var t=a(n,3),r=a(n,5);if(t||r){if(e){if(j(n,e))return s.done;r.push(e)}if(!t)throw c("modulePreloadRec",[n]);return t}var i=this;return e&&"."!=e.id?(n.parent=e,n.require.main=e.require.main,e.children.push(n)):n.require.main=n,l(n,5,e?[e]:[]),l(n,3,i.moduleLoadDefinition(n).thenSync(function(){return i.modulePreloadDependencies(n,a(n,1))}).thenSync(function(){n.preloaded=!0,l(n,3,!1),l(n,5,null)},function(e){throw c("modulePreload",[n],e)}).always(function(){n=null,i=null,e=null}))},g.moduleLoadDefinition=function(n){if(a(n,0))return s.done;var e=a(n,4);if(!e){var t=n.filename,r=this.builtinModules["/"+t];if(r)this.moduleDefine(n,[],r(this)),e=s.done;else{var i=!0,o=function(e){if(!a(n,0))throw c("moduleLoadDefinition",[n],e);i=!1};e=this.loader.moduleLoad(n).thenSync(o,o),i&&l(n,4,e)}}return e},g.moduleProcessPlugin=function(n,e){for(var t={module:n,__dirname:n.dirname,__filename:n.filename},i=e.args.slice(0),o=0,u=i.length;u>o;o++){var a=i[o];if(r.isArray(a)){if(a=a[0],!t.hasOwnProperty(a))return;i[o]=t[a]}}return this.moduleExecute(this.getModule(this.moduleResolve(n,e.module))).thenSync(function(n){var t=(n[e.method]||{}).$preload;return t?t.apply(n,i):void 0}).thenSync(null,function(t){throw c("moduleProcessPlugin",[n,e],t)})},g.modulePreloadDependencies=function(n,e){for(var t=[],i=0,o=e.length;o>i;i++){var u=e[i],a=r.isString(u)?this.modulePreload(this.getModule(this.moduleResolve(n,u)),n):this.moduleProcessPlugin(n,u);t.push(a)}return this.when(t)},g.moduleExecuteSync=function(e){if(e.loaded||a(e,2))return e.exports;var t=this.modulePreload(e);if("resolved"!=t.state())throw c("notPreloaded",[e],t.result());var r=e.exports;l(e,2,!0);try{return a(e,0).call(r,e,n),l(e,0,null),l(e,1,null),e.loaded=!0,e.exports}finally{l(e,2,!1)}},g.moduleResolve=function(n,e){return this.resolver.moduleResolve(n,e)},g.moduleRequire=function(n,e){return this.moduleExecuteSync(this.getModule(this.moduleResolve(n,e)))},g.getModule=function(n){if(!n)return new u(this);var e=this.cache[n];return e||(this.cache[n]=e=new u(this,n)),e},g.define=function(n,e,t){this.moduleDefine(this.getModule(n),e,t)},g.moduleDefine=function(n,e,t){return a(n,0)||(l(n,0,t),l(n,1,e),l(n,4,!1)),n},g.moduleExecute=function(n){var e=this;return e.modulePreload(n).thenSync(function(){return e.moduleExecuteSync(n)}).always(function(){e=null,n=null})},g.moduleAsyncRequire=function(n,e){return this.modulePreloadDependencies(n,e).thenSync(function(){for(var t=s(),i=[],o=0,u=e.length;u>o;o++){var a=e[o];r.isString(a)&&(i[o]=n.require(a))}return t.resolve.apply(t,i),t.promise()}).always(function(){n=null,e=null})},g.jsModuleDefine=function(n,e,t,r){var i=E(n,!0),o=this.jsModuleEval(n,t||e,r);return this.moduleDefine(this.getModule(e),i,o)},g.jsModuleExecute=function(n,e,t){return this.moduleExecute(this.jsModuleDefine(n,e,t))},g.jsModuleEval=function(n,e,t){var r=["(function(module, global){\nvar require = module.require, exports = module.exports, __filename = module.filename, __dirname = module.dirname;\n\n",n,"\n\n})"];return h(r.join(""),e,(t||0)+3)},g.execModuleCall=function(n){return this.moduleExecute(this.getModule(this.moduleResolve(this.rootModule,n)))},m.builtinModules=d.prototype={"/noder-js/asyncRequire.js":function(n){return function(e){e.exports={create:function(e){return o(n,e)}}}},"/noder-js/currentContext.js":function(n){return function(e){e.exports=n}}},g.Context=m,m.createContext=function(n){return new m(n).rootModule},m.expose=g.expose=function(n,e){var t=function(n){n.exports=e};this.builtinModules["/"+n]=function(){return t}},M=m}(),function(){var n={},e=m.innerHTML;/^\s*$/.test(e||"")||(n=d(e)||n);var t=m.src;if(!n.main&&t){var r=t.indexOf("?");r>-1&&(n.main=decodeURIComponent(t.substring(r+1)))}b=n}(),function(){var n=l().mainContext;i(n,b,!0),S=n}(),M.expose("noder-js/promise.js",s),M.expose("noder-js/context.js",M),M.expose("noder-js/findRequires.js",E),M.expose("noder-js/jsEval.js",h),M.expose("noder-js/request.js",f),M.expose("noder-js/asyncCall.js",a),A=M.createContext(S)})(function(){return this}(),function(){eval(arguments[0])},function(){return{mainContext:{varName:"noder"},errorContext:{main:"error.js",packaging:{baseUrl:"%scriptdir%/noderError/",requestConfig:{sync:!0}}}}});